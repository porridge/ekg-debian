# $Id$

INCLUDES = -I.. -I../lib @CURSES_INCLUDEDIR@ @READLINE_INCLUDES@
LIBS = @LIBS@ @CURSES_LIBS@ @READLINE_LIBS@
CC = @CC@ 
prefix = @prefix@
datadir = @datadir@
mandir = @mandir@
NAME = ekg
IOCTL_DAEMON_NAME = ioctl_daemon
VERSION = 0.90
RM = @RM@
MAKE = @MAKE@
AR = @AR@
install = @INSTALL@

CFLAGS = @DFLAGS@ @CFLAGS@ $(INCLUDES) -DTHEMES_DIR=\"$(datadir)/ekg/themes\" -DIOCTL_DAEMON_PATH=\"$(prefix)/bin/ioctl_daemon\" @dioctl@
OBJS = stuff.o commands.o events.o themes.o vars.o dynstuff.o userlist.o ekg.o
LOBJS = ../lib/libgadu.a

all:	ekg @do_ioctl@

ekg:	$(OBJS) $(LOBJS)
	$(CC) $(CFLAGS) -o $(NAME) $(OBJS) $(LOBJS) $(LIBS) 

ioctl_daemon:	ioctl_daemon.c
	$(CC) ioctl_daemon.c -o $(IOCTL_DAEMON_NAME)

install: all install_ekg @install_ioctl@

install_ekg:
	$(install) -m 755 ekg $(prefix)/bin

install_ioctl:
	$(install) -m 4755 ioctl_daemon $(prefix)/bin

distclean:	clean
	$(RM) -f *~ Makefile

clean:
	$(RM) -f *.o ekg ioctl_daemon search core 

