# $Id$

prefix = $(DESTDIR)@prefix@
exec_prefix = @exec_prefix@
libdir = @libdir@
includedir = @includedir@

# increased with ABI changes
VERSION_MAJOR=0
# increased with API changes
VERSION_MINOR=9

CC = @CC@ 
CFLAGS = @CFLAGS_LIBGADU@ -I.. -fPIC -Wall
LIBS = @LIBS_LIBGADU@

MAKE = @MAKE@
AR = @AR@
INSTALL = @INSTALL@
RANLIB = @RANLIB@

OBJS = common.o libgadu.o search.o pubdir.o http.o dcc.o userlist.o events.o

SHARED = libgadu.so.$(VERSION_MAJOR).$(VERSION_MINOR)
STATIC = libgadu.a

all:	@static@ @shared@

#

clean:
	rm -f *.o *.a *.so *.so.* *~ core

distclean:	clean
	rm -f Makefile

#

static: $(STATIC)

$(STATIC): $(OBJS)
	$(AR) r $(STATIC) $(OBJS) 
	$(RANLIB) $(STATIC)

#

shared:	$(SHARED)

$(SHARED): $(OBJS)
	$(CC) -g -shared -Wl,-soname=libgadu.so.$(VERSION_MAJOR) -o $(SHARED) $(OBJS) $(LIBS) -lc

#

install: @install_shared@ @install_static@

install-common:
	$(INSTALL) -d $(includedir)
	$(INSTALL) -m 644 libgadu.h $(includedir)
	$(INSTALL) -d $(libdir)

install-shared:	install-common
	$(INSTALL) -m 755 $(SHARED) $(libdir)

install-static:	install-common
	$(INSTALL) -m 755 $(STATIC) $(libdir)
	
